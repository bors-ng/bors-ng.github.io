---
layout:     post
title:      I just merged a massively breaking change
date:       2017-03-23 20:25:00
summary:    Switch your repos from the bors-ng integration to the bors integration
categories: newsletter
---

Switch your repos from the [bors-ng integration] to the [bors integration].
Because permissions.
Fixes [#64].

Sorry for the hassle.
Read further for an explanation of why this is needed.

[#64]: https://github.com/bors-ng/bors-ng/issues/64
[bors-ng integration]: https://github.com/integration/bors-ng
[bors integration]: https://github.com/integration/bors


Fixing #64
==========

Issues [#64] was a longstanding,
showstopper bug that caused pull requests to be left open after bors merged them,
and associated issues left open even though the pull request was supposed to close them after being merged.
[This issue has been successfully diagnosed and fixed on GitHub's end.][github's post]

However, the fix that was deployed by GitHub only kicks in when an integration has write access to the issue tracker.
Bors did not request this level of access, and it cannot just add that level of access to the existing integration,
so I made a new one.

[github's post]: https://platform.github.community/t/pushing-a-pull-request-doesnt-close-it/1112/5


The integration permission system
=================================

One of GitHub's biggest selling points for integrations,
over machine users and oauth applications,
is the relatively fine-grained permissions system.

Unlike OAuth applications, which either have full access to a repository or no access at all,
an integration developer can choose from eleven (11) different, disjoint,
parts of your repository that it can request read-only, read-write, or no access to.
When a user enables bors, for example, it will present them with this screen:

<div class="gallery">
<img alt="Install on your repositories. With these permissions: write access to code, read access to members and metadata, read and write access to commit statuses, issues, pages, and pull requests" src="/images/perms-screenie.png">
</div>

Once a user adds the integration to their repository, that's it.
There is no way for an integration to request additional permissions.
It certainly can't add new permissions silently;
that would defeat the purpose of having a permission system in the first place.

Though GitHub did not comment on why fixing [#64] requires adding Read/Write access for Issues,
I assume it's because they don't want Read/Write access for Code to be sufficient permission to close an Issue.
Allowing a "Write to Code, Read-Only to Issues" integration to close an isssue by pushing a commit
but not by just using the API would incentivise integration developers to hack around the permission system.
